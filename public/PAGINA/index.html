<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/PAGINA/styles.css">
    <title>DEV Community</title>
</head>
<body>
    <!-- ===== HEADER / NAVEGACION ===== -->
    <header class="topbar">
        <div class="topbar__inner">
            <!-- Logo -->
            <a class="brand" href="#">
                <img src="/IMAGENES/dev-black.png" alt="DEV Community Logo">
            </a>

            <!-- Search Bar -->
            <div class="search">
                <input class="search__input" id="searchInput" type="search" placeholder="Search...">
            </div>

            <!-- Authentication Actions (Logged Out) -->
            <div class="actions" id="authActions">
                <a href="/Login.html" class="btn btn--outline">Log in</a>
                <a href="signup.html" class="btn btn--primary">Create account</a>
            </div>

            <!-- User Navigation (Logged In) -->
            <div class="user-nav" id="userNav" style="display: none;">
                <button class="btn btn--primary" id="createPostBtn">Create Post</button>
                <button class="icon-btn" id="notificationsBtn">
                    <i class="fas fa-bell"></i>
                </button>
                <div class="user-menu">
                    <img id="userAvatar" src="/images/default-avatar.png" alt="User Avatar" class="user-avatar">
                    <div class="user-dropdown" id="userDropdown">
                        <a href="/profile" class="dropdown-item">Profile</a>
                        <a href="/dashboard" class="dropdown-item">Dashboard</a>
                        <a href="/settings" class="dropdown-item">Settings</a>
                        <div class="dropdown-divider"></div>
                        <a href="/logout" class="dropdown-item">Sign out</a>
                    </div>
                </div>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="hambtn" id="menuToggle" aria-label="menu">‚ò∞</button>
        </div>
    </header>

    <!-- ===== MAIN LAYOUT ===== -->
    <main class="layout">
        <!-- ===== LEFT SIDEBAR ===== -->
        <aside class="leftbar" id="leftbar">
            <!-- User Profile Card -->
            <section class="profilecard">
                <div class="profilecard__avatar" id="sidebarAvatar"></div>
                <div>
                    <h2 class="profilecard__name" id="sidebarUsername">Welcome</h2>
                    <p class="profilecard__meta" id="sidebarMeta">Explore the latest in development</p>
                </div>
            </section>

            <!-- Popular Tags Section -->
            <section class="section">
                <h3 class="section__title">Popular Tags</h3>
                <ul class="taglist" id="popularTags">
                    <!-- Tags populated by JavaScript -->
                </ul>
            </section>

            <!-- Topics Section -->
            <section class="section">
                <h3 class="section__title">Topics</h3>
                <ul class="topiclist">
                    <li class="topiclist__item"><a href="#" class="topiclist__link">#javascript</a></li>
                    <li class="topiclist__item"><a href="#" class="topiclist__link">#webdev</a></li>
                    <li class="topiclist__item"><a href="#" class="topiclist__link">#python</a></li>
                    <li class="topiclist__item"><a href="#" class="topiclist__link">#devops</a></li>
                    <li class="topiclist__item"><a href="#" class="topiclist__link">#machinelearning</a></li>
                </ul>
            </section>

            <!-- Resources Section -->
            <section class="section">
                <h3 class="section__title">Resources</h3>
                <ul class="resourceList">
                    <li class="resourceList__item"><a href="#" class="resourceList__link">Style Guide</a></li>
                    <li class="resourceList__item"><a href="#" class="resourceList__link">Community Rules</a></li>
                    <li class="resourceList__item"><a href="#" class="resourceList__link">Advertising</a></li>
                </ul>
            </section>
        </aside>

        <!-- ===== MAIN CONTENT ===== -->
        <section class="content">
            <!-- Hero Section -->
            <header class="hero">
                <div class="hero__inner">
                    <h1 class="hero__title">DEV Community is a community of 3,555,904 amazing developers</h1>
                    <p class="hero__description">We're a place where coders share, stay up-to-date and grow their careers.</p>
                </div>
            </header>

            <!-- Feed Controls -->
            <section class="feed-controls">
                <nav class="tabs">
                    <button class="tab tab--active" data-view="latest">Latest</button>
                    <button class="tab" data-view="top">Top</button>
                    <button class="tab" data-view="trending">Trending</button>
                </nav>

                <div class="sort">
                    Sort:
                    <select class="sort__select" id="sortSelect">
                        <option value="new">Newest</option>
                        <option value="popular">Most Popular</option>
                    </select>
                </div>
            </section>

            <!-- Articles Section -->
            <section id="articles" class="articles">
                <div class="loading" id="loading">Loading articles...</div>
            </section>
        </section>

        <!-- ===== RIGHT SIDEBAR ===== -->
        <aside class="rightbar">
            <!-- Promo Card -->
            <article class="card promo">
                <p class="promo__tag">REGISTRATION OPEN ‚Ä¢ STARTS NOW TO</p>
                <h3 class="promo__title">Kaggle G</h3>
                <p class="promo__desc">AI Agents Intensive Course Writing Challenge</p>
                <button class="btn btn--white">Learn More</button>
            </article>

            <!-- Challenges Section -->
            <section class="card">
                <h4 class="card__title">Challenges</h4>
                <ul class="small-list">
                    <li class="small-list__item">
                        <p><strong>Just Launched!</strong></p>
                        <a href="#" class="small-list__link">Agentic Postgres Challenge with Tiger Data: $3,000 in Prizes!</a>
                        <p class="challenge-desc">Build something experimental that showcases Agentic Postgres in a creative way.</p>
                    </li>
                </ul>
            </section>

            <!-- Happening Now Section -->
            <section class="card">
                <h4 class="card__title">Happening Now</h4>
                <ul class="small-list">
                    <li class="small-list__item"><a href="#" class="small-list__link">Frontend Challenge: Halloween Edition</a></li>
                    <li class="small-list__item"><a href="#" class="small-list__link">Frontend Challenge: Halloween Edition</a></li>
                </ul>
            </section>
        </aside>
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="sitefooter">
        <div class="sitefooter__inner">
            <p>&copy; 2025 DEV Community</p>
            <nav class="sitefooter__nav">
                <a href="#" class="sitefooter__link">About</a>
                <a href="#" class="sitefooter__link">Privacy</a>
                <a href="#" class="sitefooter__link">Terms</a>
            </nav>
        </div>
    </footer>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // ===== MOCK DATA =====
        const mockArticles = [
            {
                id: 1,
                title: 'Join the AI Agents Intensive Course Writing Challenge with Google and Kaggle!',
                author: 'Jess Lee',
                date: 'for The DEV Team ‚Ä¢ Oct 31',
                readTime: '3 min read',
                tags: ['googleak', 'challenge', 'kaggle', 'machinelearning', 'ai'],
                excerpt: 'Join the AI Agents Intensive Course Writing Challenge with Google and Kaggle!',
                likes: 85,
                comments: 1
            },
            {
                id: 2,
                title: 'Hacktoberfest: Contribution Chronicles',
                author: 'DEV Community',
                date: 'Oct 30',
                readTime: '5 min read',
                tags: ['hacktoberfest', 'opensource', 'github'],
                excerpt: 'Share your Hacktoberfest journey and contributions',
                likes: 42,
                comments: 3
            }
        ];

        const popularTags = ['javascript', 'webdev', 'python', 'devops', 'react', 'nodejs', 'ai', 'machinelearning'];

        // ===== DOM ELEMENTS =====
        const articlesEl = document.getElementById('articles');
        const loadingEl = document.getElementById('loading');
        const popularTagsEl = document.getElementById('popularTags');
        const searchInput = document.getElementById('searchInput');
        const sortSelect = document.getElementById('sortSelect');
        const tabs = document.querySelectorAll('.tab');
        const authActions = document.getElementById('authActions');
        const userNav = document.getElementById('userNav');
        const userAvatar = document.getElementById('userAvatar');
        const sidebarAvatar = document.getElementById('sidebarAvatar');
        const sidebarUsername = document.getElementById('sidebarUsername');
        const sidebarMeta = document.getElementById('sidebarMeta');
        const userDropdown = document.getElementById('userDropdown');
        const menuToggle = document.getElementById('menuToggle');
        const leftbar = document.getElementById('leftbar');

        // ===== AUTHENTICATION FUNCTIONS =====
        async function checkAuth() {
            try {
                const response = await fetch('/api/user');
                const data = await response.json();
                
                if (data.user) {
                    // User is authenticated
                    authActions.style.display = 'none';
                    userNav.style.display = 'flex';
                    
                    // Update user info
                    userAvatar.src = data.user.profilePicture;
                    sidebarAvatar.style.backgroundImage = `url(${data.user.profilePicture})`;
                    sidebarUsername.textContent = data.user.username;
                    sidebarMeta.textContent = 'Welcome back!';
                } else {
                    // User is not authenticated
                    authActions.style.display = 'flex';
                    userNav.style.display = 'none';
                }
            } catch (error) {
                console.error('Error checking auth:', error);
            }
        }

        // ===== USER DROPDOWN FUNCTIONS =====
        userAvatar.addEventListener('click', (e) => {
            userDropdown.style.display = userDropdown.style.display === 'block' ? 'none' : 'block';
            e.stopPropagation();
        });

        document.addEventListener('click', () => {
            userDropdown.style.display = 'none';
        });

        // ===== TAGS FUNCTIONS =====
        function renderTags() {
            popularTagsEl.innerHTML = '';
            popularTags.forEach(tag => {
                const li = document.createElement('li');
                li.className = 'taglist__item';
                li.innerHTML = `<a href="#" class="taglist__link" data-tag="${tag}">#${tag}</a>`;
                popularTagsEl.appendChild(li);
            });

            popularTagsEl.addEventListener('click', (e) => {
                const a = e.target.closest('a');
                if (!a) return;
                e.preventDefault();
                const tag = a.dataset.tag;
                searchInput.value = tag;
                doSearch();
            });
        }

        // ===== ARTICLE FUNCTIONS =====
        function articleCard(article) {
            const articleEl = document.createElement('article');
            articleEl.className = 'article';
            articleEl.innerHTML = `
                <header class="article__header">
                    <div class="article__avatar"></div>
                    <div>
                        <div class="article__author">${article.author}</div>
                        <div class="article__date">${article.date}</div>
                    </div>
                </header>
                <h3 class="article__title">${article.title}</h3>
                <div class="article__tags">
                    ${article.tags.map(t => `<span class="article__tag">#${t}</span>`).join('')}
                </div>
                <footer class="article__footer">
                    <div class="reactions">
                        <button class="reaction" data-action="like" data-id="${article.id}">‚ù§Ô∏è ${article.likes}</button>
                        <button class="reaction" data-action="comment" data-id="${article.id}">üí¨ ${article.comments}</button>
                    </div>
                    <div class="meta-right">${article.readTime}</div>
                </footer>
            `;
            return articleEl;
        }

        function renderFeed(list) {
            articlesEl.innerHTML = '';
            if (!list.length) {
                articlesEl.innerHTML = '<div class="article">No articles found.</div>';
                return;
            }
            list.forEach(a => {
                articlesEl.appendChild(articleCard(a));
            });

            // Add reaction handlers
            articlesEl.querySelectorAll('.reaction').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(btn.dataset.id, 10);
                    const action = btn.dataset.action;
                    if (action === 'like') {
                        btn.textContent = '‚ù§Ô∏è ' + (incrementLike(id));
                    } else {
                        alert('Open comments modal (simulated)');
                    }
                });
            });
        }

        function incrementLike(id) {
            const art = mockArticles.find(x => x.id === id);
            if (!art) return 0;
            art.likes = (art.likes || 0) + 1;
            return art.likes;
        }

        // ===== DATA FETCHING FUNCTIONS =====
        function fetchArticles({ sort = 'new' } = {}) {
            return new Promise(resolve => {
                setTimeout(() => {
                    let data = [...mockArticles];
                    if (sort === 'popular') data.sort((a, b) => (b.likes || 0) - (a.likes || 0));
                    else data.sort((a, b) => b.id - a.id);
                    resolve(data);
                }, 700);
            });
        }

        async function loadFeed() {
            loadingEl.style.display = 'block';
            const sort = sortSelect.value;
            const data = await fetchArticles({ sort });
            loadingEl.style.display = 'none';
            renderFeed(data);
        }

        // ===== SEARCH FUNCTION =====
        function doSearch() {
            const q = (searchInput.value || '').trim().toLowerCase();
            if (!q) {
                loadFeed();
                return;
            }
            const filtered = mockArticles.filter(a => {
                const inText = (a.title + ' ' + a.excerpt + ' ' + a.author).toLowerCase().includes(q);
                const inTags = a.tags.some(t => t.toLowerCase().includes(q.replace('#', '')));
                return inText || inTags;
            });
            renderFeed(filtered);
        }

        // ===== EVENT LISTENERS =====
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') doSearch();
        });

        sortSelect.addEventListener('change', loadFeed);

        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('tab--active'));
                tab.classList.add('tab--active');
                const view = tab.dataset.view;
                if (view === 'top') {
                    sortSelect.value = 'popular';
                } else {
                    sortSelect.value = 'new';
                }
                loadFeed();
            });
        });

        // Mobile menu toggle
        menuToggle.addEventListener('click', () => {
            leftbar.classList.toggle('open');
        });

        // ===== INITIALIZATION =====
        checkAuth();
        renderTags();
        loadFeed();
    </script>
</body>
</html>